\doxysection{client.\+h}
\hypertarget{client_8h_source}{}\label{client_8h_source}\mbox{\hyperlink{client_8h}{См. документацию.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#include\ <arpa/inet.h>}\ \ \textcolor{comment}{//inet\_addr\ define}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#include\ <sys/socket.h>}\ \textcolor{comment}{//socket(),\ connect(),\ bind(),\ listen(),\ accept(),\ select();\ }}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <ext/stdio\_filebuf.h>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <stdio.h>}\ \ \textcolor{comment}{//printf()}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <unistd.h>}\ \ \textcolor{comment}{//close(),\ fread()}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <typeinfo>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <cstring>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{abspeer_8h}{abspeer.h}}"{}}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#define\ MAXLINE\ 1024}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#define\ PORT\ 8080\ }}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#if\ 0}}
\DoxyCodeLine{00014\ <клиент>}
\DoxyCodeLine{00015\ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{00016\ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{00017\ \ \ \ \ connect()\ to\ server}
\DoxyCodeLine{00018\ \ \ \ \ \ \ \ \ \ \(\backslash\)|/}
\DoxyCodeLine{00019\ \ \ \ \ \ send\ nick\ to\ server\ }
\DoxyCodeLine{00020\ \ \ \ \ \ \ \ \ \ \(\backslash\)|/}
\DoxyCodeLine{00021\ \ \_\_\_\_\_\_\_\_\_\_\_\_\_\(\backslash\)\ loop(infinite)}
\DoxyCodeLine{00022\ \ |\ \ \ \ \ \ \ \ /\ \ \ |}
\DoxyCodeLine{00023\ \ |\ \ \ \ \ \ \ \ |}
\DoxyCodeLine{00024\ \ |\ \ \ \ \ \ \ \(\backslash\)|/}
\DoxyCodeLine{00025\ \ |\ \ set\ sockets\ to\ listen(stdin\ and\ self\ (client))}
\DoxyCodeLine{00026\ \ |\ \ \ \ \ \ \ \ |}
\DoxyCodeLine{00027\ \ |\ \ \ \ \ \ \ \ |}
\DoxyCodeLine{00028\ \ |\ \ \ \ \ \ \ \(\backslash\)|/}
\DoxyCodeLine{00029\ \ |\ \ select()\ wait\ for\ messages(0\ fd\ is\ stdin,\ and\ other\ fd\ is\ connection\ descriptor)}
\DoxyCodeLine{00030\ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{00031\ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{00032\ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)|/\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)|/}
\DoxyCodeLine{00033\ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ stdin\ -\/\ send\ messg\ to\ server\ \ \ \ \ \ recive\ mess\ from\ server}
\DoxyCodeLine{00034\ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{00035\ \ |\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_|\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_|}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{comment}{//вводим\ определение\ клиента\ и\ сервера}}
\DoxyCodeLine{00048\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classClient}{Client}}:\textcolor{keyword}{public}\ \mbox{\hyperlink{classPeer}{Peer}}\{}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00050\ \ \ \ \ \mbox{\hyperlink{classClient_ae51af7aa6b8f591496a8f6a4a87a14bf}{Client}}()\{\};}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{comment}{//Client(int\ \_sock,\ struct\ sockaddr\_in\ \_addres):AbstractPeer(\_sock,\ \_addres)\{\}}}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{comment}{//int\ sock;}}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \textcolor{comment}{//struct\ sockaddr\_in\ addres;}}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \textcolor{comment}{//char\ buffer[MAXLINE]=\{0\};}}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \textcolor{comment}{//fd\_set\ read\_fd=\{0\};}}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{comment}{//template<class\ T>\ T\ *conn(T\ *);}}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{comment}{//auto\ *init(auto\ *);}}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{comment}{//template<class\ T>\ T\ *sel(T\ *);}}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{comment}{//template<class\ T>\ T\ *init1(T\ *);}}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{comment}{//auto\ *selinit(auto\ *);}}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{comment}{//template<class\ T>\ T\ *sendmes(T\ *);}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classClient_ab6e28571c7e03c08a7215d819b5724c1}{createSocket}}()\textcolor{keyword}{\ override}\{}
\DoxyCodeLine{00064\ \ \ \ \ \mbox{\hyperlink{classPeer_a925963413d249aec471b34561070610c}{sock}}=socket(AF\_INET,\ SOCK\_STREAM,\ 0);}
\DoxyCodeLine{00065\ \ \ \ \ std::cout\ <<\ \textcolor{keyword}{typeid}(\textcolor{keyword}{this}).name()\ <<\ \textcolor{stringliteral}{"{}\ fd\ "{}}\ <<\ \mbox{\hyperlink{classPeer_a925963413d249aec471b34561070610c}{sock}}\ <<\ std::endl;}
\DoxyCodeLine{00066\ \}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classClient_ab545746cd6506829340ad8ec9441889c}{connectInit}}()\ override\ }
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \ \ \mbox{\hyperlink{classPeer_a6095fc5a3aa90625e70276cd3790060e}{addres}}.sin\_family\ =\ AF\_INET;}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPeer_a6095fc5a3aa90625e70276cd3790060e}{addres}}.sin\_port\ =\ htons(\mbox{\hyperlink{client_8h_a614217d263be1fb1a5f76e2ff7be19a2}{PORT}});}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPeer_a6095fc5a3aa90625e70276cd3790060e}{addres}}.sin\_addr.s\_addr\ =\ inet\_addr(\textcolor{stringliteral}{"{}127.0.0.1"{}});}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ connect(\mbox{\hyperlink{classPeer_a925963413d249aec471b34561070610c}{sock}},\ (\textcolor{keyword}{struct}\ sockaddr*)\&\mbox{\hyperlink{classPeer_a6095fc5a3aa90625e70276cd3790060e}{addres}},\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classPeer_a6095fc5a3aa90625e70276cd3790060e}{addres}}));}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \textcolor{comment}{//dprintf(peer-\/>sock,\ s);}}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{comment}{//std::cout\ <<"{}test"{}\ <<std::endl;}}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classClient_aebf9b314550b1b959bd407c76bbda8da}{selinit}}()\textcolor{keyword}{\ override}\{}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ memset(\mbox{\hyperlink{classPeer_aeff6367e659ac6c6a649603198e56021}{buffer}},\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classPeer_aeff6367e659ac6c6a649603198e56021}{buffer}}));}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FD\_ZERO(\&\mbox{\hyperlink{classPeer_a456be0991e60ae9d77c52ef647410cc6}{read\_fd}});}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FD\_SET(0,\ \&\mbox{\hyperlink{classPeer_a456be0991e60ae9d77c52ef647410cc6}{read\_fd}});}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FD\_SET(\mbox{\hyperlink{classPeer_a925963413d249aec471b34561070610c}{sock}},\ \&\mbox{\hyperlink{classPeer_a456be0991e60ae9d77c52ef647410cc6}{read\_fd}});}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \}}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classClient_af563c26b27356624c6c7bb2a51452dac}{sel}}()\textcolor{keyword}{\ override}\{}
\DoxyCodeLine{00097\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ select(300,\ \&peer-\/>read\_fd,\ NULL,\ NULL,\ NULL);}}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this};}
\DoxyCodeLine{00100\ \}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classClient_acc7125848be8c7872f5c8a94eb01f88d}{conn}}()\textcolor{keyword}{\ override}\{}
\DoxyCodeLine{00105\ read(\mbox{\hyperlink{classPeer_a925963413d249aec471b34561070610c}{sock}},\ \mbox{\hyperlink{classPeer_aeff6367e659ac6c6a649603198e56021}{buffer}},\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classPeer_aeff6367e659ac6c6a649603198e56021}{buffer}}));dprintf(0,\ \mbox{\hyperlink{classPeer_aeff6367e659ac6c6a649603198e56021}{buffer}});\textcolor{comment}{//\}}}
\DoxyCodeLine{00106\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this};}
\DoxyCodeLine{00107\ \}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classClient_a8088c82969a26911550ccf13ca89c587}{sendmes}}()\textcolor{keyword}{\ override}\{}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \textcolor{keywordflow}{if}(FD\_ISSET(0,\ \&\mbox{\hyperlink{classPeer_a456be0991e60ae9d77c52ef647410cc6}{read\_fd}}))\{read(0,\ \mbox{\hyperlink{classPeer_aeff6367e659ac6c6a649603198e56021}{buffer}},\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classPeer_aeff6367e659ac6c6a649603198e56021}{buffer}}));dprintf(\mbox{\hyperlink{classPeer_a925963413d249aec471b34561070610c}{sock}},\ \mbox{\hyperlink{classPeer_aeff6367e659ac6c6a649603198e56021}{buffer}});\}\ \ }
\DoxyCodeLine{00113\ \textcolor{comment}{//if(FD\_ISSET(sock,\ \&read\_fd))\{read(sock,\ buffer,\ sizeof(buffer));dprintf(0,\ buffer);\}}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this};}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \}}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \};}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ }

\end{DoxyCode}

\doxysection{client.\+h}
\hypertarget{client_8h_source}{}\label{client_8h_source}\mbox{\hyperlink{client_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#include\ <arpa/inet.h>}\ \ \textcolor{comment}{//inet\_addr\ define}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#include\ <sys/socket.h>}\ \textcolor{comment}{//socket(),\ connect(),\ bind(),\ listen(),\ accept(),\ select();\ }}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <ext/stdio\_filebuf.h>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <stdio.h>}\ \ \textcolor{comment}{//printf()}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <unistd.h>}\ \ \textcolor{comment}{//close(),\ fread()}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <typeinfo>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <cstring>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{abspeer_8h}{abspeer.h}}"{}}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#define\ MAXLINE\ 1024}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#define\ PORT\ 8080\ }}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#if\ 0}}
\DoxyCodeLine{00014\ <клиент>}
\DoxyCodeLine{00015\ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{00016\ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{00017\ \ \ \ \ connect()\ to\ server}
\DoxyCodeLine{00018\ \ \ \ \ \ \ \ \ \ \(\backslash\)|/}
\DoxyCodeLine{00019\ \ \ \ \ \ send\ nick\ to\ server\ }
\DoxyCodeLine{00020\ \ \ \ \ \ \ \ \ \ \(\backslash\)|/}
\DoxyCodeLine{00021\ \ \_\_\_\_\_\_\_\_\_\_\_\_\_\(\backslash\)\ loop(infinite)}
\DoxyCodeLine{00022\ \ |\ \ \ \ \ \ \ \ /\ \ \ |}
\DoxyCodeLine{00023\ \ |\ \ \ \ \ \ \ \ |}
\DoxyCodeLine{00024\ \ |\ \ \ \ \ \ \ \(\backslash\)|/}
\DoxyCodeLine{00025\ \ |\ \ set\ sockets\ to\ listen(stdin\ and\ self\ (client))}
\DoxyCodeLine{00026\ \ |\ \ \ \ \ \ \ \ |}
\DoxyCodeLine{00027\ \ |\ \ \ \ \ \ \ \ |}
\DoxyCodeLine{00028\ \ |\ \ \ \ \ \ \ \(\backslash\)|/}
\DoxyCodeLine{00029\ \ |\ \ select()\ wait\ for\ messages(0\ fd\ is\ stdin,\ and\ other\ fd\ is\ connection\ descriptor)}
\DoxyCodeLine{00030\ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{00031\ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{00032\ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)|/\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)|/}
\DoxyCodeLine{00033\ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ stdin\ -\/\ send\ messg\ to\ server\ \ \ \ \ \ recive\ mess\ from\ server}
\DoxyCodeLine{00034\ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ |}
\DoxyCodeLine{00035\ \ |\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_|\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_|}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{comment}{//вводим\ определение\ клиента\ и\ сервера}}
\DoxyCodeLine{00048\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classConcreteClient}{ConcreteClient}}:\textcolor{keyword}{public}\ \mbox{\hyperlink{classAbstractPeer}{AbstractPeer}}\{}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00050\ \ \ \ \ \mbox{\hyperlink{classConcreteClient_a29fbca9daa3b17f9e425a7f45fab1097}{ConcreteClient}}()\{\};}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{comment}{//Client(int\ \_sock,\ struct\ sockaddr\_in\ \_addres):AbstractPeer(\_sock,\ \_addres)\{\}}}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{comment}{//int\ sock;}}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \textcolor{comment}{//struct\ sockaddr\_in\ addres;}}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \textcolor{comment}{//char\ buffer[MAXLINE]=\{0\};}}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \textcolor{comment}{//fd\_set\ read\_fd=\{0\};}}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{comment}{//template<class\ T>\ T\ *conn(T\ *);}}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{comment}{//auto\ *init(auto\ *);}}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{comment}{//template<class\ T>\ T\ *sel(T\ *);}}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{comment}{//template<class\ T>\ T\ *init1(T\ *);}}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{comment}{//auto\ *selinit(auto\ *);}}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{comment}{//template<class\ T>\ T\ *sendmes(T\ *);}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classConcreteClient_a3273856cbdf5a4035053a02572853a4d}{init}}()\textcolor{keyword}{\ override}\{}
\DoxyCodeLine{00064\ \ \ \ \ \mbox{\hyperlink{classAbstractPeer_ab7b3e18a6b0dc4659bb3946bab8eb091}{sock}}=socket(AF\_INET,\ SOCK\_STREAM,\ 0);}
\DoxyCodeLine{00065\ \ \ \ \ std::cout\ <<\ \textcolor{keyword}{typeid}(\textcolor{keyword}{this}).name()\ <<\ \textcolor{stringliteral}{"{}\ fd\ "{}}\ <<\ \mbox{\hyperlink{classAbstractPeer_ab7b3e18a6b0dc4659bb3946bab8eb091}{sock}}\ <<\ std::endl;}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this};}
\DoxyCodeLine{00068\ \}}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classConcreteClient_a631189fac7eef569066f18776aa177e1}{init1}}()\textcolor{keyword}{\ override}}
\DoxyCodeLine{00071\ \textcolor{keyword}{\ \ \ \ \ \ \ \ }\{}
\DoxyCodeLine{00072\ \ \ \ \ std::cout<<\textcolor{stringliteral}{"{}client\ start\ "{}}\ \ <<\ std::endl;}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \ \ \mbox{\hyperlink{classAbstractPeer_a115afffee11f94131732b973908d989f}{addres}}.sin\_family\ =\ AF\_INET;}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classAbstractPeer_a115afffee11f94131732b973908d989f}{addres}}.sin\_port\ =\ htons(\mbox{\hyperlink{client_8h_a614217d263be1fb1a5f76e2ff7be19a2}{PORT}});}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classAbstractPeer_a115afffee11f94131732b973908d989f}{addres}}.sin\_addr.s\_addr\ =\ inet\_addr(\textcolor{stringliteral}{"{}127.0.0.1"{}});}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ connect(\mbox{\hyperlink{classAbstractPeer_ab7b3e18a6b0dc4659bb3946bab8eb091}{sock}},\ (\textcolor{keyword}{struct}\ sockaddr*)\&\mbox{\hyperlink{classAbstractPeer_a115afffee11f94131732b973908d989f}{addres}},\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classAbstractPeer_a115afffee11f94131732b973908d989f}{addres}}));}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \textcolor{comment}{//dprintf(peer-\/>sock,\ s);}}
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{comment}{//std::cout\ <<"{}test"{}\ <<std::endl;}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classConcreteClient_a0cc4bf8a1613f9c9d55c7b38319c24a4}{selinit}}()\textcolor{keyword}{\ override}\{}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ memset(\mbox{\hyperlink{classAbstractPeer_a08a4bdba86cc87e04aa721d79ca2c904}{buffer}},\ 0,\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classAbstractPeer_a08a4bdba86cc87e04aa721d79ca2c904}{buffer}}));}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FD\_ZERO(\&\mbox{\hyperlink{classAbstractPeer_a9beb7080532de3bcb5ec0b9a5a438e0f}{read\_fd}});}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FD\_SET(0,\ \&\mbox{\hyperlink{classAbstractPeer_a9beb7080532de3bcb5ec0b9a5a438e0f}{read\_fd}});}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FD\_SET(\mbox{\hyperlink{classAbstractPeer_ab7b3e18a6b0dc4659bb3946bab8eb091}{sock}},\ \&\mbox{\hyperlink{classAbstractPeer_a9beb7080532de3bcb5ec0b9a5a438e0f}{read\_fd}});}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classConcreteClient_a61159ff8fc211d454bcdb299447745bb}{sel}}()\textcolor{keyword}{\ override}\{}
\DoxyCodeLine{00100\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ select(300,\ \&peer-\/>read\_fd,\ NULL,\ NULL,\ NULL);}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this};}
\DoxyCodeLine{00103\ \}}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classConcreteClient_a6fecba49bc938e7c4e3ec850ebda2e95}{conn}}()\textcolor{keyword}{\ override}\{}
\DoxyCodeLine{00108\ read(\mbox{\hyperlink{classAbstractPeer_ab7b3e18a6b0dc4659bb3946bab8eb091}{sock}},\ \mbox{\hyperlink{classAbstractPeer_a08a4bdba86cc87e04aa721d79ca2c904}{buffer}},\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classAbstractPeer_a08a4bdba86cc87e04aa721d79ca2c904}{buffer}}));dprintf(0,\ \mbox{\hyperlink{classAbstractPeer_a08a4bdba86cc87e04aa721d79ca2c904}{buffer}});\textcolor{comment}{//\}}}
\DoxyCodeLine{00109\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this};}
\DoxyCodeLine{00110\ \}}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classConcreteClient_a86c48189cf80e7bd18b698e64924fa46}{sendmes}}()\textcolor{keyword}{\ override}\{}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \textcolor{keywordflow}{if}(FD\_ISSET(0,\ \&\mbox{\hyperlink{classAbstractPeer_a9beb7080532de3bcb5ec0b9a5a438e0f}{read\_fd}}))\{read(0,\ \mbox{\hyperlink{classAbstractPeer_a08a4bdba86cc87e04aa721d79ca2c904}{buffer}},\textcolor{keyword}{sizeof}(\mbox{\hyperlink{classAbstractPeer_a08a4bdba86cc87e04aa721d79ca2c904}{buffer}}));dprintf(\mbox{\hyperlink{classAbstractPeer_ab7b3e18a6b0dc4659bb3946bab8eb091}{sock}},\ \mbox{\hyperlink{classAbstractPeer_a08a4bdba86cc87e04aa721d79ca2c904}{buffer}});\}\ \ }
\DoxyCodeLine{00116\ \textcolor{comment}{//if(FD\_ISSET(sock,\ \&read\_fd))\{read(sock,\ buffer,\ sizeof(buffer));dprintf(0,\ buffer);\}}}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this};}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \}}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \};}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ }

\end{DoxyCode}
